<!doctype html>




<html class="theme-next muse" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Fragment," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="Fragment的懒加载有2种情况，一种ViewPager+Fragment配合使用的懒加载。一种是单纯只有Fragment的懒加载。我们结合源码来寻找解决方案。">
<meta name="keywords" content="Fragment">
<meta property="og:type" content="article">
<meta property="og:title" content="Fragment的懒加载">
<meta property="og:url" content="https://luwenjie.me/2017/04/21/Fragmnet的懒加载/index.html">
<meta property="og:site_name" content="luwenjie&#39;s Blog">
<meta property="og:description" content="Fragment的懒加载有2种情况，一种ViewPager+Fragment配合使用的懒加载。一种是单纯只有Fragment的懒加载。我们结合源码来寻找解决方案。">
<meta property="og:image" content="http://img.blog.csdn.net/20160428203327414">
<meta property="og:updated_time" content="2017-04-21T10:50:14.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fragment的懒加载">
<meta name="twitter:description" content="Fragment的懒加载有2种情况，一种ViewPager+Fragment配合使用的懒加载。一种是单纯只有Fragment的懒加载。我们结合源码来寻找解决方案。">
<meta name="twitter:image" content="http://img.blog.csdn.net/20160428203327414">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://luwenjie.me/2017/04/21/Fragmnet的懒加载/"/>





  <title>Fragment的懒加载 | luwenjie's Blog</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  















  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">luwenjie's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://luwenjie.me/2017/04/21/Fragmnet的懒加载/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luwenjie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="luwenjie's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Fragment的懒加载</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-21T18:15:00+08:00">
                2017-04-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2017/04/21/Fragmnet的懒加载/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Fragment的懒加载有2种情况，一种ViewPager+Fragment配合使用的懒加载。<br>一种是单纯只有Fragment的懒加载。我们结合源码来寻找解决方案。<br><a id="more"></a></p>
<h2 id="Fragment的生命周期"><a href="#Fragment的生命周期" class="headerlink" title="Fragment的生命周期"></a>Fragment的生命周期</h2><p>首先了解一下Fragment的生命周期。<br><img src="http://img.blog.csdn.net/20160428203327414" alt=""><br>这里我们需要做懒加载的话关注一下初始化的时候它的生命周期就可以了，看看能不能再生命周期里面做一些手脚。</p>
<h2 id="只有Fragment的懒加载"><a href="#只有Fragment的懒加载" class="headerlink" title="只有Fragment的懒加载"></a>只有Fragment的懒加载</h2><p>一般首页都是像iOS那种底栏的设计UI。点击下方的按钮切换fragment，这时不需要使用ViewPager+Fragment来实现，只需要动态显示或者隐藏Fragment就行。</p>
<p>假设现在首页有A，B，C，D四个页面，点击按钮切换。<br>在Activity初始化先把A页面添加进去，点击其他页面的时候再Add。</p>
<pre><code class="java">public class MainActivity extends AppCompatActivity implements View.OnClickListener {
  private static final String TAG = &quot;MainActivity&quot;;
  final Fragment[] mFragments = new Fragment[4];
  private int mCurrentPosition;

  @Override protected void onCreate(@Nullable Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.act_main);

    findViewById(R.id.a_bt).setOnClickListener(this);
    findViewById(R.id.b_bt).setOnClickListener(this);
    findViewById(R.id.c_bt).setOnClickListener(this);
    findViewById(R.id.d_bt).setOnClickListener(this);

    mFragments[0] = FragmentA.newInstance();

    getSupportFragmentManager().beginTransaction()
        .add(R.id.container, mFragments[0], createTag(mFragments[0]))
        .commit();
  }

  @Override public void onClick(View v) {
    switch (v.getId()) {
      case R.id.a_bt:
        switchFragment(0);
        break;
      case R.id.b_bt:
        switchFragment(1);
        break;
      case R.id.c_bt:
        switchFragment(2);
        break;
      case R.id.d_bt:
        switchFragment(3);
        break;
    }
  }

  /**
   * 切换Fragment
   *
   * @param toPosition 点击的position
   */
  private void switchFragment(int toPosition) {
    if (mCurrentPosition == toPosition) return;
    FragmentTransaction fragmentTransaction = getSupportFragmentManager().beginTransaction();
    if (mFragments[toPosition] == null) {
      mFragments[toPosition] = newFragmentInstance(toPosition);
    }
    if (!mFragments[toPosition].isAdded()) {
      fragmentTransaction.add(R.id.container, mFragments[toPosition],
          createTag(mFragments[toPosition]));
    }
    fragmentTransaction.hide(mFragments[mCurrentPosition]).show(mFragments[toPosition]).commit();
    Log.d(TAG, mCurrentPosition + &quot;&quot;);
    mCurrentPosition = toPosition;
  }

  private Fragment newFragmentInstance(int position) {
    switch (position) {
      case 0:
        return FragmentA.newInstance();
      case 1:
        return FragmentB.newInstance();
      case 2:
        return FragmentC.newInstance();
      case 3:
        return FragmentD.newInstance();
    }
    return null;
  }

  private String createTag(Fragment fragment) {
    return fragment.getClass().getName();
  }
}
</code></pre>
<h2 id="ViewPager-Fragment懒加载"><a href="#ViewPager-Fragment懒加载" class="headerlink" title="ViewPager + Fragment懒加载"></a>ViewPager + Fragment懒加载</h2><p>一般是这样使用的：</p>
<pre><code class="java"> mViewPager.setAdapter(new FragmentPagerAdapter(getSupportFragmentManager()) {
      @Override public Fragment getItem(int position) {
        return mFragments[position];
      }

      @Override public int getCount() {
        return mFragments.length;
      }
    });
</code></pre>
<p>不难猜测fragment的处理都是在FragmentAdapter这个类里面，所以直接看这个类是如果处理的。</p>
<h3 id="FragmentPagerAdapter源码走读"><a href="#FragmentPagerAdapter源码走读" class="headerlink" title="FragmentPagerAdapter源码走读"></a>FragmentPagerAdapter源码走读</h3><p>源码其实很简单，是一个单独的类，我把它copy出来方便打印日志和写注释：  </p>
<pre><code class="java">public abstract class FragmentPagerAdapter extends PagerAdapter {
  private static final String TAG = &quot;FragmentPagerAdapter&quot;;
  private static final boolean DEBUG = true;

  private final FragmentManager mFragmentManager;
  private FragmentTransaction mCurTransaction = null;
  private Fragment mCurrentPrimaryItem = null;

  public FragmentPagerAdapter(FragmentManager fm) {
    mFragmentManager = fm;
  }

  private static String makeFragmentName(int viewId, long id) {
    String s = &quot;android:switcher:&quot; + viewId + &quot;:&quot; + id;
    Log.d(TAG, s);
    return s;
  }

  /**
   * Return the Fragment associated with a specified position.
   */
  public abstract Fragment getItem(int position);

  @Override public void startUpdate(ViewGroup container) {
    if (container.getId() == View.NO_ID) {
      throw new IllegalStateException(&quot;ViewPager with adapter &quot; + this + &quot; requires a view id&quot;);
    }
  }

  @Override public Object instantiateItem(ViewGroup container, int position) {
    if (mCurTransaction == null) {
      mCurTransaction = mFragmentManager.beginTransaction();
    }

    // 获得item的唯一id
    final long itemId = getItemId(position);

    // Do we already have this fragment?
    // 由itemId和viewPager的id生成一组Tag标记Fragment
    String name = makeFragmentName(container.getId(), itemId);
    // 通过tag去找fragment
    Fragment fragment = mFragmentManager.findFragmentByTag(name);
    // 如果不为空的话说明这个fragment已经添加过了，只是被detach了，就重新attach这个fragment
    if (fragment != null) {
      if (DEBUG) Log.v(TAG, &quot;Attaching item #&quot; + itemId + &quot;: f=&quot; + fragment);
      mCurTransaction.attach(fragment);
    } else {
      // 如果为空，创建一个Fragment，添加进去。
      fragment = getItem(position);
      if (DEBUG) Log.v(TAG, &quot;Adding item #&quot; + itemId + &quot;: f=&quot; + fragment);
      mCurTransaction.add(container.getId(), fragment, makeFragmentName(container.getId(), itemId));
    }
    // 如果当期显示的fragment不是这里初始化的fragment，将这里的fragment设置为用户不可见
    if (fragment != mCurrentPrimaryItem) {
      fragment.setMenuVisibility(false);
      fragment.setUserVisibleHint(false);
    }

    return fragment;
  }

  @Override public void destroyItem(ViewGroup container, int position, Object object) {
    if (mCurTransaction == null) {
      mCurTransaction = mFragmentManager.beginTransaction();
    }
    if (DEBUG) {
      Log.v(TAG, &quot;Detaching item #&quot;
          + getItemId(position)
          + &quot;: f=&quot;
          + object
          + &quot; v=&quot;
          + ((Fragment) object).getView());
    }
    mCurTransaction.detach((Fragment) object);
  }

  @Override public void setPrimaryItem(ViewGroup container, int position, Object object) {
    Fragment fragment = (Fragment) object;

    // 这里展现给用户可见的fragment是object，所以需要把mCurrentPrimaryItem设置为不可见，
    // object设置为可见。
    if (fragment != mCurrentPrimaryItem) {
      if (mCurrentPrimaryItem != null) {
        mCurrentPrimaryItem.setMenuVisibility(false);
        mCurrentPrimaryItem.setUserVisibleHint(false);
      }
      if (fragment != null) {
        fragment.setMenuVisibility(true);
        fragment.setUserVisibleHint(true);
      }
      mCurrentPrimaryItem = fragment;
    }
  }

  @Override public void finishUpdate(ViewGroup container) {
    if (mCurTransaction != null) {
      mCurTransaction.commitNowAllowingStateLoss();
      mCurTransaction = null;
    }
  }

  @Override public boolean isViewFromObject(View view, Object object) {
    return ((Fragment) object).getView() == view;
  }

  @Override public Parcelable saveState() {
    return null;
  }

  @Override public void restoreState(Parcelable state, ClassLoader loader) {
  }

  /**
   * Return a unique identifier for the item at the given position.
   *
   * &lt;p&gt;The default implementation returns the given position.
   * Subclasses should override this method if the positions of items can change.&lt;/p&gt;
   *
   * @param position Position within this adapter
   * @return Unique identifier for the item at position
   */
  public long getItemId(int position) {
    return position;
  }
}
</code></pre>
<p>重点关注<code>instantiateItem</code>和<code>setPrimaryItem</code>这两个方法。在<code>instantiateItem</code>中通过TAG来找fragment，没有的话就初始化添加到frament事务中。有的话直接Attach。关键是这里设置了fragment的可见状态。<code>setPrimaryItem</code>中也是对当前fragment可见状态做了标记。所以我们来仔细看看<code>setUserVisibleHint</code>这个方法。</p>
<h3 id="setUserVisibleHint-源码走读"><a href="#setUserVisibleHint-源码走读" class="headerlink" title="setUserVisibleHint 源码走读"></a>setUserVisibleHint 源码走读</h3><p>这个方法用来设置ui是否对用户可见。<br>这个方法不会自动调用，是需要手动调用的，其实就是设置了一个boolean标记，没有做什么特殊处理。<br>viewpager里面左右切换fragment的时候对frgament设置了setUserVisibleHint，所以我们是不是可以通过这个可见性标记来处理懒加载？  </p>
<pre><code class="java"> /**
  * 设置一个标记，标注用户是否可以看到Fragment的UI。默认是可见的，为true。
  * 在fragment实例状态保存和恢复之间，这个标记是持久化存在的。
  *
  * 当fragment被滚动到屏幕之外，这时是不可见的。或者，不想直接对用户可见。
  * 系统可以使用这一点来优先处理诸如片段生命周期更新或加载器排序行为的操作。
  *
  * 注意：此方法可能在片段生命周期之外调用。 因此在fragment生命周期方法调用中没有排序保证。
  *
  * @param isVisibleToUser 如果此fragment的UI当前对用户可见（默认），则为true，否则为false。
  */
  public void setUserVisibleHint(boolean isVisibleToUser) {
    // 如果原来对用户不可见 &amp;&amp; 现在要设置为可见 &amp;&amp; 状态在started之前
    // &amp;&amp; mFragmentManager不为空 &amp;&amp; 已经被添加到Activity了
    // 就执行performPendingDeferredStart()这个方法
    if (!mUserVisibleHint
        &amp;&amp; isVisibleToUser
        &amp;&amp; mState &lt; STARTED
        &amp;&amp; mFragmentManager != null
        &amp;&amp; isAdded()) {
      mFragmentManager.performPendingDeferredStart(this);
    }
    mUserVisibleHint = isVisibleToUser;
    mDeferStart = mState &lt; STARTED &amp;&amp; !isVisibleToUser;
  }
</code></pre>
<pre><code class="java">public void performPendingDeferredStart(Fragment f) {
        if (f.mDeferStart) {
            if (mExecutingActions) {
                // Wait until we&#39;re done executing our pending transactions
                mHavePendingDeferredStart = true;
                return;
            }
            f.mDeferStart = false;
            moveToState(f, mCurState, 0, 0, false);
        }
    }
</code></pre>
<h3 id="ViewPager"><a href="#ViewPager" class="headerlink" title="ViewPager"></a>ViewPager</h3><p>#/frameworks/base/core/java/com/android/internal/widget/ViewPager.java</p>
<pre><code class="java">//每次切换ViewPager的Tab时调用的方法
void populate(int newCurrentItem) {

        mAdapter.startUpdate(this);

        //......
        addNewItem(mCurItem, curIndex);
        // mCurItem 为当前可见Fragment
        // 调用setUserVisibleHint(true)
        mAdapter.setPrimaryItem(this, mCurItem, curItem != null ? curItem.object : null); 

        // 在这里调用了mCurTransaction.commitNowAllowingStateLoss();开始初始化 fragment，
        // 所以setUserVisibleHint是在整个frament生命周期之前调用的
        mAdapter.finishUpdate(this);

        //.....

 }


ItemInfo addNewItem(int position, int index) {
        ItemInfo ii = new ItemInfo();
        ii.position = position;
        // 初始化fragment, 这里调用了setUserVisibleHint(false)
        ii.object = mAdapter.instantiateItem(this, position);
        ii.widthFactor = mAdapter.getPageWidth(position);
        if (index &lt; 0 || index &gt;= mItems.size()) {
            mItems.add(ii);
        } else {
            mItems.add(index, ii);
        }
        return ii;
}
</code></pre>
<p>ViewPager在创建Fragment之前，初始化的时候先设置setUserVisibleHint(false)，<br>在当前页面对用户可见的时候调用setUserVisibleHint(true)。所有的操作完成后最后将执行frgament.commit()。所以setUserVisibleHint都是先于fragment的生命周期调用的。  </p>
<p>使用FragmentAdapter并不会销毁Fragment实例，只会销毁View。</p>
<pre><code class="java">onPause
onStop
onDestroyView
</code></pre>
<p>因为setUserVisibleHint最先调用，所以避免空指针需要判断View是否都初始化完毕了。<br>根据这个思路我用2个map来保存每个fragment的view是否初始化了，和是否加载过数据。当fragment销毁view时重置标记。代码如下：fragment需要实现getPosition表明他的position。</p>
<pre><code class="java">/**
 * author: Amaze
 * date: 2017/4/20 11:44
 * des: 适用于ViewPager懒加载fragment
 */

public abstract class LazyViewPagerFragment extends Fragment {
  private static final String TAG = &quot;LazyViewPagerFragment&quot;;
  private final SparseBooleanArray mIsViewCreatedArray = new SparseBooleanArray();// 存储view是否加载完
  private final SparseBooleanArray mIsDataLoadedArray = new SparseBooleanArray();// 存储数据是否加载过了

  @Override public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);

    mIsViewCreatedArray.put(getPosition(), true); // 初始化完了View
    if (getUserVisibleHint()) {
      loadData();
      mIsDataLoadedArray.put(getPosition(), true);
    }
  }

  @Override public void onDestroyView() {
    super.onDestroyView();
    // 销毁时重置
    reset();
  }

  private void reset() {
    mIsViewCreatedArray.put(getPosition(), false); // 默认没有初始化View
    mIsDataLoadedArray.put(getPosition(), false); // 默认没有加载过数据
  }

  @Override public void onCreate(@Nullable Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    reset();
  }

  @Override public void onHiddenChanged(boolean hidden) {
    super.onHiddenChanged(hidden);
  }

  @Override public void setUserVisibleHint(boolean isVisibleToUser) {
    super.setUserVisibleHint(isVisibleToUser);

    // 如果对用户可见且初始化完毕
    if (isVisibleToUser &amp;&amp; mIsViewCreatedArray.get(getPosition()) &amp;&amp; !mIsDataLoadedArray.get(
        getPosition())) {
      loadData();
      mIsDataLoadedArray.put(getPosition(), true);
    }
  }

  protected abstract void loadData();

  protected abstract int getPosition();
}
</code></pre>
<h3 id="FragmentAdapter和FragmentStatePagerAdapter的区别"><a href="#FragmentAdapter和FragmentStatePagerAdapter的区别" class="headerlink" title="FragmentAdapter和FragmentStatePagerAdapter的区别"></a>FragmentAdapter和FragmentStatePagerAdapter的区别</h3><p>观察生命周期，当ViewPager销毁frgament的时候：  </p>
<pre><code class="java">// FragmentAdapter：
onPause
onStop
onDestroyView  

// FragmentStatePagerAdapter
onPause
onStop
onDestroyView
onDestroy
onDetach
</code></pre>
<p>所以之后重新创建的时候：</p>
<pre><code class="java">// FragmentAdapter：
onViewCreated
onStart
onResume

// FragmentStatePagerAdapter
onAttach
onCreate
onViewCreated
onStart
onResume
</code></pre>
<p>FragmentStatePagerAdapter完全把fragment移除了，FragmentAdapter只是销毁了View。因此FragmentStatePagerAdapter里面用Bundle保存数据以便恢复。</p>
<p>FragmentStatePagerAdapter对内存开销更小，复杂页面应该使用这个。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://blog.csdn.net/czhpxl007/article/details/51277319" target="_blank" rel="external">Fragment的setUserVisibleHint详解</a>  </p>
<p><a href="http://blog.csdn.net/maosidiaoxian/article/details/38300627" target="_blank" rel="external">Andriod开发技巧——Fragment的懒加载</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Fragment/" rel="tag"># Fragment</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/19/Java_dynamicProxy/" rel="next" title="Java的动态代理">
                <i class="fa fa-chevron-left"></i> Java的动态代理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/24/Java的注解/" rel="prev" title="Java的注解">
                Java的注解 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="luwenjie" />
          <p class="site-author-name" itemprop="name">luwenjie</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Fragment的生命周期"><span class="nav-number">1.</span> <span class="nav-text">Fragment的生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#只有Fragment的懒加载"><span class="nav-number">2.</span> <span class="nav-text">只有Fragment的懒加载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ViewPager-Fragment懒加载"><span class="nav-number">3.</span> <span class="nav-text">ViewPager + Fragment懒加载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FragmentPagerAdapter源码走读"><span class="nav-number">3.1.</span> <span class="nav-text">FragmentPagerAdapter源码走读</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setUserVisibleHint-源码走读"><span class="nav-number">3.2.</span> <span class="nav-text">setUserVisibleHint 源码走读</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ViewPager"><span class="nav-number">3.3.</span> <span class="nav-text">ViewPager</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FragmentAdapter和FragmentStatePagerAdapter的区别"><span class="nav-number">3.4.</span> <span class="nav-text">FragmentAdapter和FragmentStatePagerAdapter的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">4.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">luwenjie</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "2ab4175d0069412cbcb722431b663013",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  

  

  

  

  

</body>
</html>
